

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>colorPV &mdash; EDM to PyDM Migration Guide 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="visibilityPV" href="visibilityPV.html" />
    <link rel="prev" title="Learning" href="../learning.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> EDM to PyDM Migration Guide
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../learning.html">Learning</a></li>
</ul>
<p class="caption"><span class="caption-text">How-To</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">colorPV</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#guide">Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visibilityPV.html">visibilityPV</a></li>
</ul>
<p class="caption"><span class="caption-text">Example Run Non-Layout Mode</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../example-walk-through/start_with_qdesigner.html">Start with Qt Designer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example-walk-through/convert_existing_edm.html">Convert an Existing EDM Screen to a PyDM Screen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example-walk-through/stylesheets.html">Touch Up and Stylesheets</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contrib/help.html">Getting Help With PyDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contrib/requests.html">Bug and Requests</a></li>
</ul>
<p class="caption"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab/pydm">PyDM GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/slaclab">SLAC-wide GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://controlssoftware.sns.ornl.gov/edm">EDM Website</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EDM to PyDM Migration Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>colorPV</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/how-to/colorPV.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="colorpv">
<h1>colorPV<a class="headerlink" href="#colorpv" title="Permalink to this headline">¶</a></h1>
<div class="section" id="guide">
<h2>Guide<a class="headerlink" href="#guide" title="Permalink to this headline">¶</a></h2>
<p>With EDM the <cite>colorPV</cite> property is often used to bring alarm coloring from a different PV.
PyDM widgets do not have a specific property for a coloring/alarm Channel. The pattern to
be used is to add a PyDMFrame widget and add your widget inside of it.</p>
<p>The PyDMFrame has a channel property in which the PV used as <cite>colorPV</cite> at EDM can be
configured. This will make the inner widget be affected by the changes in Alarm associated with
the PyDMFrame.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>For this screen, we want add alarm behavior from a PV (<code class="docutils literal notranslate"><span class="pre">EDM2PYDM:VALUE</span></code>) into
a line edit which uses a PV (<code class="docutils literal notranslate"><span class="pre">EDM2PYDM:NOALARM</span></code>) with no alarm information.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example uses an EPICS database with simulated PVs which can be
downloaded at the end of this page.</p>
</div>
<ul>
<li><p><strong>Step 1.</strong></p>
<p>Let’s start by opening Qt Designer and creating a new <code class="docutils literal notranslate"><span class="pre">Widget</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/new_widget.gif"><img alt="../_images/new_widget.gif" src="../_images/new_widget.gif" style="width: 552.0px; height: 340.0px;" /></a>
</div>
</li>
<li><p><strong>Step 2.</strong></p>
<p>Now that we have our form, let’s go ahead and add the Widgets.</p>
</li>
<li><p><strong>Step 2.1</strong></p>
<p>The first widget that we will add is the PyDMFrame that will wrap our Line
Edit later.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Drag and drop a <code class="docutils literal notranslate"><span class="pre">PyDMFrame</span></code> into the form created at <strong>Step 1</strong>.</p></li>
<li><p>Make it big enough so you can fit the next widget later.</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">alarmSensitiveBorder</span></code> property to <code class="docutils literal notranslate"><span class="pre">true/checked</span></code>.</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">channel</span></code> property to <code class="docutils literal notranslate"><span class="pre">ca://EDM2PYDM:VALUE</span></code>.</p></li>
</ol>
</div></blockquote>
</li>
<li><p><strong>Step 2.2</strong></p>
<p>Let’s add the Line Edit which will display the other PV value inside of the
Frame</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Drag and drop a <code class="docutils literal notranslate"><span class="pre">PyDMLineEdit</span></code> into the <code class="docutils literal notranslate"><span class="pre">PyDMFrame</span></code> created at <strong>Step 2.1</strong>.</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">channel</span></code> property to <code class="docutils literal notranslate"><span class="pre">ca://EDM2PYDM:NOALARM</span></code>.</p></li>
</ol>
</div></blockquote>
</li>
<li><p><strong>Step 2.3</strong></p>
<p>In order to make life easier for the demonstration of this feature, let’s add
a <code class="docutils literal notranslate"><span class="pre">PyDMSlider</span></code> so we can control the values of the alarm PV and simulate the
alarm conditions.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Drag and drop a <code class="docutils literal notranslate"><span class="pre">PyDMSlider</span></code> into the form created at <strong>Step 1</strong> below
the frame (not inside of it).</p></li>
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">channel</span></code> property to <code class="docutils literal notranslate"><span class="pre">ca://EDM2PYDM:VALUE</span></code>.</p></li>
</ol>
</div></blockquote>
</li>
<li><p><strong>Step 3.</strong></p>
<p>Save your file (suggested name as <code class="docutils literal notranslate"><span class="pre">colorPV.ui</span></code>) and test the example above.</p>
<p>In one terminal run the example EPICS database:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>softIoc -d colorPV.db
</pre></div>
</div>
<p>In another terminal run the example Display:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pydm colorPV.ui
</pre></div>
</div>
<p>Once you move the slider the Frame will now have its border highlighted
according to the stylesheet defined for alarms.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/colorPV.gif"><img alt="../_images/colorPV.gif" src="../_images/colorPV.gif" style="width: 544.0px; height: 432.0px;" /></a>
</div>
</li>
<li><p><strong>Step Bonus</strong></p>
<p>You may have noticed that the PyDMFrame only applied the border to itself.
That is intentionally done to preserve the look and feel of the inner widgets.
But one can customize how the local PyDMFrame stylesheet property to act upon the
inner widgets.</p>
<p>Here is an example in which we set the stylesheet at the <code class="docutils literal notranslate"><span class="pre">PyDMFrame</span></code> widget
to also change the font color of the inner widgets via the <code class="docutils literal notranslate"><span class="pre">color</span></code> property
if the PyDMFrame has the <code class="docutils literal notranslate"><span class="pre">alarmSensitiveBorder</span></code> property checked:</p>
<ol class="arabic">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">PyDMFrame</span></code> stylesheet property to the following:</p>
<blockquote>
<div><div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="c">/* alarmSeverity</span>
<span class="c">0 - No Alarm</span>
<span class="c">1 - Minor Alarm</span>
<span class="c">2 - Major Alarm</span>
<span class="c">3 - Invalid Alarm</span>
<span class="c">4 - Disconnected</span>
<span class="c">*/</span>
<span class="nt">PyDMFrame</span><span class="o">[</span><span class="nt">alarmSensitiveBorder</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">][</span><span class="nt">alarmSeverity</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">]</span> <span class="nt">QWidget</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">green</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">PyDMFrame</span><span class="o">[</span><span class="nt">alarmSensitiveBorder</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">][</span><span class="nt">alarmSeverity</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">]</span> <span class="nt">QWidget</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">yellow</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">PyDMFrame</span><span class="o">[</span><span class="nt">alarmSensitiveBorder</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">][</span><span class="nt">alarmSeverity</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">]</span> <span class="nt">QWidget</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">red</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">PyDMFrame</span><span class="o">[</span><span class="nt">alarmSensitiveBorder</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">][</span><span class="nt">alarmSeverity</span><span class="o">=</span><span class="s2">&quot;3&quot;</span><span class="o">]</span> <span class="nt">QWidget</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">purple</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">PyDMFrame</span><span class="o">[</span><span class="nt">alarmSensitiveBorder</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">][</span><span class="nt">alarmSeverity</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">]</span> <span class="nt">QWidget</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">white</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Running the colorPV.ui file with this snippet inside will produce the
following result:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/colorPV_bonus.gif"><img alt="../_images/colorPV_bonus.gif" src="../_images/colorPV_bonus.gif" style="width: 544.0px; height: 432.0px;" /></a>
</div>
</li>
</ol>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can download the UI file using <a class="reference download internal" download="" href="../_downloads/8c35a64c1b537d1093d35cb2d754cfc7/colorPV.ui"><code class="xref download docutils literal notranslate"><span class="pre">this</span> <span class="pre">link</span></code></a>
and the EPICS db file using <a class="reference download internal" download="" href="../_downloads/d5230a901e2fc306fd2a741c5e8b44b7/colorPV.db"><code class="xref download docutils literal notranslate"><span class="pre">this</span> <span class="pre">other</span> <span class="pre">link</span></code></a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="visibilityPV.html" class="btn btn-neutral float-right" title="visibilityPV" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../learning.html" class="btn btn-neutral float-left" title="Learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, mgibbs, hhslepicka.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>